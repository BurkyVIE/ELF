# LIBRARIES ----
library(tidyverse)

# DATA ----
present <- 2025

## Complete list of Franchise, Team, ... by Season ----
teamdata_elf <- tribble(~Franchise, ~Team, ~Conference, ~Division, ~HomeField,
### A B C D E ----                        
         "Bravos", tribble(~Team, ~Abb, ~Season,
                           "Madrid Bravos", "MB", 2024:present),
                   tribble(~Conference, ~Season,
                           "Western", 2024),
                   tribble(~Division, ~Season,
                           "South", 2025:present),
                   tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                           "Estadio Vallehermoso", "Madrid, ES", 1, 40.441694, -3.71, 2024:present),
      "Centurions", tribble(~Team, ~Abb, ~Season,
                            "Cologne Centurions", "CC", 2021:present),
                    tribble(~Conference, ~Season,
                            "Southern", 2022,
                            "Western", 2023:2024),
                    tribble(~Division, ~Season,
                            "South", 2021,
                            "West", 2025:present),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Südstadion", "Cologne, DE", 3/5, 50.9175, 6.9436, 2021,
                            "Ostkampfbahn (Müngersdorfer Stadion)", "Cologne, DE", 2/5, 50.9350649430564, 6.875977991422235, 2021,
                            "Südstadion", "Cologne, DE", 1, 50.9175, 6.9436, 2022,
                            "Südstadion", "Cologne, DE", 4/6, 50.9175, 6.9436, 2023,
                            "Sportpark Höhenberg", "Cologne, DE", 2/6, 50.9452, 7.0304, 2023,
                            "Südstadion", "Cologne, DE", 2/6, 50.9175, 6.9436, 2024,
                            "Tivoli", "Aachen, DE", 4/6, 50.793333, 6.097222, 2024,
                            "Südstadion", "Cologne, DE", 1, 50.9175, 6.9436, 2025:present),
         "Dragons", tribble(~Team, ~Abb, ~Season,
                            "Barcelona Dragons", "BD", 2021:2024),
                    tribble(~Conference, ~Season,
                            "Southern", 2022,
                            "Central", 2023:2024),
                    tribble(~Division, ~Season,
                            "South", 2021),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Estadi Municipal de Reus", "Reus, ES", 1, 41.156389, 1.085556, 2021:2022,
                            "Estadio Olímpico de Tarrasa", "Tarrasa, ES", 1, 41.576133, 2.011142, 2023,
                            "Estadio municipal de Badalona", "Badalona, ES", 1, 41.456261, 2.236828, 2024),
      "Enthroners", tribble(~Team, ~Abb, ~Season,
                            "Fehervar Enthroners", "FE", 2023:present),
                    tribble(~Conference, ~Season,
                            "Eastern", 2023:2024),
                    tribble(~Division, ~Season,
                            "East", 2025:present),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "First Field", "Székesfehérvár, HU", 1, 47.183636, 18.434803, 2023:present),
### F G H I J ----
            "Fire", tribble(~Team, ~Abb, ~Season,
                            "Rhein Fire", "RF", 2022:present),
                    tribble(~Conference, ~Season,
                            "Southern", 2022,
                            "Western", 2023:2024),
                    tribble(~Division, ~Season,
                            "North", 2025:present),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Schauinsland-Reisen-Arena (MSV-Arena)", "Duisburg, DE", 1, 51.409033, 6.778664, 2022:2023,
                            "Niederrheinstadion", "Oberhausen, DE", 1/6, 51.493611, 6.854444, 2024,
                            "Schauinsland-Reisen-Arena (MSV-Arena)", "Duisburg, DE", 5/6, 51.409033, 6.778664, 2024,
                            "Schauinsland-Reisen-Arena (MSV-Arena)", "Duisburg, DE", 5/6, 51.409033, 6.778664, 2025,
                            "Merkur Spiel-Arena", "Düsseldorf, DE", 1/6, 51.261635, 6.733163, 2025),
          "Galaxy", tribble(~Team, ~Abb, ~Season,
                            "Frankfurt Galaxy", "FG", 2021:present),
                    tribble(~Conference, ~Season,
                            "Central", 2022,
                            "Western", 2023:2024),
                    tribble(~Division, ~Season,
                            "South", 2021,
                            "West", 2025:present),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "PSD Bank Arena (Stadion am Bornheimer Hang)", "Frankfurt, DE", 1, 50.128056, 8.723333, 2021:present),
          "Guards", tribble(~Team, ~Abb, ~Season,
                            "Helvetic Guards", "HG", 2023),
                    tribble(~Conference, ~Season,
                            "Central", 2023),
                    tribble(~Division, ~Season,
                            NA, NA),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Lidl Arena (Stadion Bergholz)", "Wil, CH", 1, 47.458333, 9.037222, 2023),
### K L M N O ----
           "Kings", tribble(~Team, ~Abb, ~Season,
                            "Leipzig Kings", "LK", 2021:2023),
                    tribble(~Conference, ~Season,
                            "Northern", 2022,
                            "Eastern", 2023:2023),
                    tribble(~Division, ~Season,
                            "North", 2021),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Alfred-Kunze-Sportpark", "Leipzig, DE", 1, 51.358056, 12.307778, 2021,
                            "Paul Greifzu Stadium", "Dessau-Roßlau, DE", 1/6, 51.823889, 12.251667, 2022,
                            "Leuna Chemie Stadion", "Halle (Saale), DE", 1/6, 51.465278, 11.961944, 2022,
                            "Bruno-Plache-Stadion", "Leipzig, DE", 4/6, 51.302778, 12.419167, 2022,
                            "Bruno-Plache-Stadion", "Leipzig, DE", 1, 51.302778, 12.419167, 2023),
           "Lions", tribble(~Team, ~Abb, ~Season,
                            "Prague Lions", "PL", 2023:present),
                    tribble(~Conference, ~Season,
                            "Eastern", 2023:2024),
                    tribble(~Division, ~Season,
                            "East", 2025:present),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Stadion FK Viktoria Žižkov", "Prague, CZ", 4/6, 50.083872, 14.444589, 2023,
                            "Sportovní centrum Hostivař", "Prague, CZ", 1/6, 50.05058242731488, 14.547959192782962, 2023,
                            "Atletický stadion Slavia Praha", "Prague, CZ", 1/6, 50.067135751397146, 14.478030327247977, 2023,
                            "Stadion FK Viktoria Žižkov", "Prague, CZ", 1/6, 50.083872, 14.444589, 2024,
                            "Atletický stadion Slavia Praha", "Prague, CZ", 4/6, 50.067135751397146, 14.478030327247977, 2024,
                            "Městský stadion", "Ústí nad Labem, CZ", 1/6, 50.675745, 14.016387, 2024,
                            "Atletický stadion Slavia Praha", "Prague, CZ", 1, 50.067135751397146, 14.478030327247977, 2025:present),
     "Mercenaries", tribble(~Team, ~Abb, ~Season,
                            "Helvetic Mercenaries", "HG", 2024:present),
                    tribble(~Conference, ~Season,
                            "Central", 2024),
                    tribble(~Division, ~Season,
                            "South", 2025:present),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Stadion Brühl", "Grenchen, CH", 1/6, 47.185409, 7.404031, 2024,
                            "Sportzentrum Kleinfeld", "Kriens, CH", 5/6, 47.03, 8.288056, 2024,
                            "Sportzentrum Kleinfeld", "Kriens, CH", 1, 47.03, 8.288056, 2024:present),
      "Musketeers", tribble(~Team, ~Abb, ~Season,
                            "Paris Musketeers", "PM", 2023:present),
                    tribble(~Conference, ~Season,
                            "Western", 2023:2024),
                    tribble(~Division, ~Season,
                            "West", 2025:present),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Stade Jean-Bouin", "Paris, FR", 1, 48.843056, 2.252778, 2023,
                            "Stade du Hainaut", "Valenciennes, FR", 1/6, 50.348389, 3.531611, 2024,
                            "Stade Jean-Bouin", "Paris, FR", 5/6, 48.843056, 2.252778, 2024,
                            "Stade Jean-Bouin", "Paris, FR", 1, 48.843056, 2.252778, 2025:present),
### P Q R S T ----
        "Panthers", tribble(~Team, ~Abb, ~Season,
                            "Panthers Wroclaw", "PW", 2021:present),
                    tribble(~Conference, ~Season,
                            "Northern", 2022,
                            "Eastern", 2023:2024),
                    tribble(~Division, ~Season,
                            "North", 2021,
                            "East", 2025:present),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Stadion Olimpijski", "Wroclaw, PL", 1, 51.119444, 17.096667, 2021:2023,
                            "Tarczyński Arena Wrocław", "Wroclaw, PL", 1/6, 51.141167, 16.943778, 2024,
                            "Stadion Olimpijski", "Wroclaw, PL", 5/6, 51.119444, 17.096667, 2024,
                            "Tarczyński Arena Wrocław", "Wroclaw, PL", 1/6, 51.141167, 16.943778, 2025,
                            "Stadion Olimpijski", "Wroclaw, PL", 5/6, 51.119444, 17.096667, 2025),
         "Raiders", tribble(~Team, ~Abb, ~Season,
                            "Raiders Tirol", "RT", 2022:present),
                    tribble(~Conference, ~Season,
                            "Central", 2022:2024),
                    tribble(~Division, ~Season,
                            "South", 2025:present),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Tivoli Stadion Tirol", "Innsbruck, AT", 1, 47.255833, 11.410833, 2022:present),
            "Rams", tribble(~Team, ~Abb, ~Season,
                            "Istanbul Rams", "IR", 2022),
                    tribble(~Conference, ~Season,
                            "Southern", 2022),
                    tribble(~Division, ~Season,
                            NA, NA),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Maltepe Hasan Polat Stadium", "Istanbul, TR", 1, 40.9205, 29.1313, 2022),
          "Ravens", tribble(~Team, ~Abb, ~Season,
                            "Munich Ravens", "MR", 2023:present),
                    tribble(~Conference, ~Season,
                            "Central", 2023:2024),
                    tribble(~Division, ~Season,
                            "South", 2025:present),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Alpenbauer Sportpark (Sportpark Unterhaching)", "Unterhaching, DE", 1, 48.073611, 11.615556, 2023,
                            "Uhlsport Sportpark (Sportpark Unterhaching)", "Unterhaching, DE", 5/6, 48.073611, 11.615556, 2024,
                            "Max-Morlock-Stadion", "Nuremberg, DE", 1/6, 49.426111, 11.125833, 2024,
                            "Uhlsport Sportpark (Sportpark Unterhaching)", "Unterhaching, DE", 1, 48.073611, 11.615556, 2025:present),
          "Seamen", tribble(~Team, ~Abb, ~Season,
                            "Milano Seamen", "MS", 2023:2024),
                    tribble(~Conference, ~Season,
                            "Central", 2023:2024),
                    tribble(~Division, ~Season,
                            NA, NA),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Velodromo Maspes-Vigorelli", "Milan, IT", 1, 45.481389, 9.158056, 2023:2024),
      "Sea Devils", tribble(~Team, ~Abb, ~Season,
                            "Hamburg Sea Devils", "HD", 2021:present),
                    tribble(~Conference, ~Season,
                            "Northern", 2022,
                            "Western", 2023:2024),
                    tribble(~Division, ~Season,
                            "North", c(2021, 2025:present)),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Stadion Hoheluft", "Hamburg, DE", 1, 53.587222, 9.969722, 2021:present),
           "Storm", tribble(~Team, ~Abb, ~Season,
                            "Nordic Storm", "NS", 2025:present),
                    tribble(~Conference, ~Season,
                            NA, NA),
                    tribble(~Division, ~Season,
                            "North", 2025:present),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Galdsaxe Stadion", "Søborg, DK", 1, 55.7328, 12.4967, 2025:present),
           "Surge", tribble(~Team, ~Abb, ~Season,
                            "Stuttgart Surge", "SS", 2021:present),
                    tribble(~Conference, ~Season,
                            "Central", 2022:2024),
                    tribble(~Division, ~Season,
                            "South", 2021,
                            "West", 2025:present),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Gazi-Stadion auf der Waldau (Waldau-Stadion)", "Stuttgart, DE", 1, 48.753944, 9.188417, 2021:2023,
                            "PreZero Arena (Rhein-Neckar-Arena)", "Sinsheim, DE", 1/6, 49.238056, 8.8875, 2024,
                            "Stadion an der Kreuzeiche", "Reutlingen, DE", 2/6, 48.478611, 9.19, 2024,
                            "Gazi-Stadion auf der Waldau (Waldau-Stadion)", "Stuttgart, DE", 3/6, 48.753944, 9.188417, 2024,
                            "Gazi-Stadion auf der Waldau (Waldau-Stadion)", "Stuttgart, DE", 1, 48.753944, 9.188417, 2025:present),
         "Thunder", tribble(~Team, ~Abb, ~Season,
                            "Berlin Thunder", "BT", 2021:present),
                    tribble(~Conference, ~Season,
                            "Northern", 2022,
                            "Eastern", 2023:2024),
                    tribble(~Division, ~Season,
                            "North", c(2021,2025:present)),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Olympiapark-Amateurstadion (Stadion auf dem Wurfplatz)", "Berlin, DE", 2/5, 52.517191, 13.236694, 2021,
                            "Friedrich-Ludwig-Jahn-Sportpark", "Berlin, DE", 3/5, 52.543056, 13.405278, 2021,
                            "Friedrich-Ludwig-Jahn-Sportpark", "Berlin, DE", 1, 52.543056, 13.405278, 2022:present),
### U V W X Y Z ----
         "Vikings", tribble(~Team, ~Abb, ~Season,
                            "Vienna Vikings", "VV", 2022:present),
                    tribble(~Conference, ~Season,
                            "Central", 2022,
                            "Eastern", 2023:2024),
                    tribble(~Division, ~Season,
                            "East", 2025:present),
                    tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                            "Generali Arena", "Vienna, AT", 1, 48.162345, 16.387156, 2022,
                            "Generali Arena", "Vienna, AT", 1/6, 48.162345, 16.387156, 2023,
                            "Naturarena Hohe Warte", "Vienna, AT", 4/6, 48.248898, 16.359694, 2023,
                            "Footballzentrum Ravelinstraße", "Vienna, AT", 1/6, 48.172145848736214, 16.425254712887714, 2023,
                            "Generali Arena", "Vienna, AT", 3/6, 48.162345, 16.387156, 2024,
                            "Wiener Neustadt Arena", "Wr. Neustadt, AT", 3/6, 47.840926, 16.257464, 2024,
                            "Generali Arena", "Vienna, AT", 3/6, 48.162345, 16.387156, 2025,
                            "Wiener Neustadt Arena", "Wr. Neustadt, AT", 3/6, 47.840926, 16.257464, 2025)
                    )

# TRANSFORM ----
## Teamdata ----
teamdata_elf <- teamdata_elf |>
  mutate(across(Team:HomeField, ~ modify(.x, ~ unnest_longer(., "Season")))) # expandiere Seasons in nested tibbles

## Team_info ----
teaminfo_elf <-
  select(teamdata_elf, Franchise, Team) |> unnest_longer(Team) |> unpack(Team) |>                   # extrahiere TEAM Info
  left_join(
    select(teamdata_elf, Franchise, Conference) |> unnest_longer(Conference) |> unpack(Conference), # extrahiere CONFERENCE Info
    by = c("Franchise", "Season")) |>
  left_join(
    select(teamdata_elf, Franchise, Division) |> unnest_longer(Division) |> unpack(Division),       # extrahiere DIVISION Info
    by = c("Franchise", "Season"))  

## Team_location ----
teamloc_elf <- 
  select(teamdata_elf, Franchise, HomeField) |> unnest_longer(HomeField) |> unpack(HomeField) |> # extrahiere HOMEFIELD Info
  left_join(
    teaminfo_elf |> select(Season, Franchise, Conference, Division),
    by = c("Franchise", "Season"))

# DIVISION/CONFERENCE COLORS ----
## Colors ----
colors_elf <- list(
  Division = tribble(~Name, ~Color, ~Season,
                     "North", "#b4b7fa", 2021,
                     "South", "#f6cdcb", 2021,
                     "North", "#B3B7FF", 2025,
                     "East", "#B3FFB7", 2025,
                     "South", "#FFD700", 2025,
                     "West", "#FFCBCB", 2025),
  Conference = tribble(~Name, ~Color, ~Season,
                       "Central", "#1e3264", 2022:present,
                       "Northern", "#b4b7fa", 2022,
                       "Southern", "#f6cdcb", 2022,
                       "Eastern", "#244530", 2023:present,
                       "Western", "#ad302c", 2023: present)
)

## Expandiere ----  
colors_elf <- lapply(colors_elf, unnest_longer, "Season")

# RESPONSE ----
cat("..ELF > Team data imported ✔\n")

# CLEAN UP ----
rm(present, teamdata_elf)
