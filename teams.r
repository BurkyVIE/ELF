# LIBRARIES ----
library(tidyverse)

# DATA ----
present <- 2025L

## Complete list of Franchise, Team, ... by Season ----
teamdata_elf <- tribble(~Franchise, ~Team, ~Conference, ~Division, ~HomeField,
  ### A B C D E ----                        
              "Bravos", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Madrid Bravos", "MB", "MAD", 2024L:present),
                        tribble(~Conference, ~Season,
                                "Western", 2024L),
                        tribble(~Division, ~Season,
                                "South", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Estadio Vallehermoso", "Madrid, ES", 1, 40.441694, -3.71, 2024L:present),
          "Centurions", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Cologne Centurions", "CC", "CCE", 2021L:present),
                        tribble(~Conference, ~Season,
                                "Southern", 2022L,
                                "Western", 2023L:2024L),
                        tribble(~Division, ~Season,
                                "South", 2021L,
                                "West", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Südstadion", "Cologne, DE", 3/5, 50.9175, 6.9436, 2021L,
                                "Ostkampfbahn (Müngersdorfer Stadion)", "Cologne, DE", 2/5, 50.9350649430564, 6.875977991422235, 2021L,
                                "Südstadion", "Cologne, DE", 1, 50.9175, 6.9436, 2022L,
                                "Südstadion", "Cologne, DE", 4/6, 50.9175, 6.9436, 2023L,
                                "Sportpark Höhenberg", "Cologne, DE", 2/6, 50.9452, 7.0304, 2023L,
                                "Südstadion", "Cologne, DE", 2/6, 50.9175, 6.9436, 2024L,
                                "Tivoli", "Aachen, DE", 4/6, 50.793333, 6.097222, 2024L,
                                "Südstadion", "Cologne, DE", 1, 50.9175, 6.9436, 2025L:present),
             "Dragons", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Barcelona Dragons", "BD", "BDR", 2021L:2024L),
                        tribble(~Conference, ~Season,
                                "Southern", 2022L,
                                "Central", 2023L:2024L),
                        tribble(~Division, ~Season,
                                "South", 2021L),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Estadi Municipal de Reus", "Reus, ES", 1, 41.156389, 1.085556, 2021L:2022L,
                                "Estadio Olímpico de Tarrasa", "Tarrasa, ES", 1, 41.576133, 2.011142, 2023L,
                                "Estadio municipal de Badalona", "Badalona, ES", 1, 41.456261, 2.236828, 2024L),
          "Enthroners", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Fehervar Enthroners", "FE", "ENT", 2023L:present),
                        tribble(~Conference, ~Season,
                                "Eastern", 2023L:2024L),
                        tribble(~Division, ~Season,
                                "East", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "First Field", "Székesfehérvár, HU", 1, 47.183636, 18.434803, 2023L:present),
  ### F G H I J ----
                "Fire", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Rhein Fire", "RF", "RHF", 2022L:present),
                        tribble(~Conference, ~Season,
                                "Southern", 2022L,
                                "Western", 2023L:2024L),
                        tribble(~Division, ~Season,
                                "North", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Schauinsland-Reisen-Arena (MSV-Arena)", "Duisburg, DE", 1, 51.409033, 6.778664, 2022L:2023L,
                                "Niederrheinstadion", "Oberhausen, DE", 1/6, 51.493611, 6.854444, 2024L,
                                "Schauinsland-Reisen-Arena (MSV-Arena)", "Duisburg, DE", 5/6, 51.409033, 6.778664, 2024L,
                                "Schauinsland-Reisen-Arena (MSV-Arena)", "Duisburg, DE", 5/6, 51.409033, 6.778664, 2025L,
                                "Merkur Spiel-Arena", "Düsseldorf, DE", 1/6, 51.261635, 6.733163, 2025L),
              "Galaxy", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Frankfurt Galaxy", "FG", "FGY", 2021L:present),
                        tribble(~Conference, ~Season,
                                "Central", 2022L,
                                "Western", 2023L:2024L),
                        tribble(~Division, ~Season,
                                "South", 2021L,
                                "West", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "PSD Bank Arena (Stadion am Bornheimer Hang)", "Frankfurt, DE", 1, 50.128056, 8.723333, 2021L:present),
              "Guards", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Helvetic Guards", "HG", "HVG", 2023L),
                        tribble(~Conference, ~Season,
                                "Central", 2023L),
                        tribble(~Division, ~Season,
                                NA, NA),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Lidl Arena (Stadion Bergholz)", "Wil, CH", 1, 47.458333, 9.037222, 2023L),
                        ### K L M N O ----
               "Kings", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Leipzig Kings", "LK", "LKG", 2021L:2023L),
                        tribble(~Conference, ~Season,
                                "Northern", 2022L,
                                "Eastern", 2023L:2023L),
                        tribble(~Division, ~Season,
                                "North", 2021L),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Alfred-Kunze-Sportpark", "Leipzig, DE", 1, 51.358056, 12.307778, 2021L,
                                "Paul Greifzu Stadium", "Dessau-Roßlau, DE", 1/6, 51.823889, 12.251667, 2022L,
                                "Leuna Chemie Stadion", "Halle (Saale), DE", 1/6, 51.465278, 11.961944, 2022L,
                                "Bruno-Plache-Stadion", "Leipzig, DE", 4/6, 51.302778, 12.419167, 2022L,
                                "Bruno-Plache-Stadion", "Leipzig, DE", 1, 51.302778, 12.419167, 2023L),
               "Lions", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Prague Lions", "PL", "PRG", 2023L:present),
                        tribble(~Conference, ~Season,
                                "Eastern", 2023L:2024L),
                        tribble(~Division, ~Season,
                                "East", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Stadion FK Viktoria Žižkov", "Prague, CZ", 4/6, 50.083872, 14.444589, 2023L,
                                "Sportovní centrum Hostivař", "Prague, CZ", 1/6, 50.05058242731488, 14.547959192782962, 2023L,
                                "Atletický stadion Slavia Praha", "Prague, CZ", 1/6, 50.067135751397146, 14.478030327247977, 2023L,
                                "Stadion FK Viktoria Žižkov", "Prague, CZ", 1/6, 50.083872, 14.444589, 2024L,
                                "Atletický stadion Slavia Praha", "Prague, CZ", 4/6, 50.067135751397146, 14.478030327247977, 2024L,
                                "Městský stadion", "Ústí nad Labem, CZ", 1/6, 50.675745, 14.016387, 2024L,
                                "Atletický stadion Slavia Praha", "Prague, CZ", 1, 50.067135751397146, 14.478030327247977, 2025L:present),
         "Mercenaries", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Helvetic Mercenaries", "HG", "HVM", 2024L:present),
                        tribble(~Conference, ~Season,
                                "Central", 2024L),
                        tribble(~Division, ~Season,
                                "South", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Stadion Brühl", "Grenchen, CH", 1/6, 47.185409, 7.404031, 2024L,
                                "Sportzentrum Kleinfeld", "Kriens, CH", 5/6, 47.03, 8.288056, 2024L,
                                "Sportzentrum Kleinfeld", "Kriens, CH", 1, 47.03, 8.288056, 2025L:present),
          "Musketeers", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Paris Musketeers", "PM", "PAR", 2023L:present),
                        tribble(~Conference, ~Season,
                                "Western", 2023L:2024L),
                        tribble(~Division, ~Season,
                                "West", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Stade Jean-Bouin", "Paris, FR", 1, 48.843056, 2.252778, 2023L,
                                "Stade du Hainaut", "Valenciennes, FR", 1/6, 50.348389, 3.531611, 2024L,
                                "Stade Jean-Bouin", "Paris, FR", 5/6, 48.843056, 2.252778, 2024L,
                                "Stade Jean-Bouin", "Paris, FR", 1, 48.843056, 2.252778, 2025L:present),
  ### P Q R S T ----
            "Panthers", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Panthers Wroclaw", "PW", "WPA", 2021L:present),
                        tribble(~Conference, ~Season,
                                "Northern", 2022L,
                                "Eastern", 2023L:2024L),
                        tribble(~Division, ~Season,
                                "North", 2021L,
                                "East", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Stadion Olimpijski", "Wroclaw, PL", 1, 51.119444, 17.096667, 2021L:2023L,
                                "Tarczyński Arena Wrocław", "Wroclaw, PL", 1/6, 51.141167, 16.943778, 2024L,
                                "Stadion Olimpijski", "Wroclaw, PL", 5/6, 51.119444, 17.096667, 2024L,
                                "Tarczyński Arena Wrocław", "Wroclaw, PL", 1/6, 51.141167, 16.943778, 2025L,
                                "Stadion Olimpijski", "Wroclaw, PL", 5/6, 51.119444, 17.096667, 2025L),
             "Raiders", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Raiders Tirol", "RT", "RAI", 2022L:present),
                        tribble(~Conference, ~Season,
                                "Central", 2022L:2024L),
                        tribble(~Division, ~Season,
                                "South", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Tivoli Stadion Tirol", "Innsbruck, AT", 1, 47.255833, 11.410833, 2022L:present),
                "Rams", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Istanbul Rams", "IR", "IST", 2022L),
                        tribble(~Conference, ~Season,
                                "Southern", 2022L),
                        tribble(~Division, ~Season,
                                NA, NA),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Maltepe Hasan Polat Stadium", "Istanbul, TR", 1, 40.9205, 29.1313, 2022L),
              "Ravens", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Munich Ravens", "MR", "MUC", 2023L:present),
                        tribble(~Conference, ~Season,
                                "Central", 2023L:2024L),
                        tribble(~Division, ~Season,
                                "South", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Alpenbauer Sportpark (Sportpark Unterhaching)", "Unterhaching, DE", 1, 48.073611, 11.615556, 2023L,
                                "Uhlsport Sportpark (Sportpark Unterhaching)", "Unterhaching, DE", 5/6, 48.073611, 11.615556, 2024L,
                                "Max-Morlock-Stadion", "Nuremberg, DE", 1/6, 49.426111, 11.125833, 2024L,
                                "Uhlsport Sportpark (Sportpark Unterhaching)", "Unterhaching, DE", 1, 48.073611, 11.615556, 2025L:present),
              "Seamen", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Milano Seamen", "MS", "MIL", 2023L:2024L),
                        tribble(~Conference, ~Season,
                                "Central", 2023L:2024L),
                        tribble(~Division, ~Season,
                                NA, NA),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Velodromo Maspes-Vigorelli", "Milan, IT", 1, 45.481389, 9.158056, 2023L:2024L),
          "Sea Devils", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Hamburg Sea Devils", "HD", "HSD", 2021L:present),
                        tribble(~Conference, ~Season,
                                "Northern", 2022L,
                                "Western", 2023L:2024L),
                        tribble(~Division, ~Season,
                                "North", c(2021L, 2025L:present)),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Stadion Hoheluft", "Hamburg, DE", 1, 53.587222, 9.969722, 2021L:present),
               "Storm", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Nordic Storm", "NO", "NDS", 2025L:present),
                        tribble(~Conference, ~Season,
                                NA, NA),
                        tribble(~Division, ~Season,
                                "North", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Galdsaxe Stadion", "Søborg, DK", 1, 55.7328, 12.4967, 2025L:present),
               "Surge", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Stuttgart Surge", "SS", "SRG", 2021L:present),
                        tribble(~Conference, ~Season,
                                "Central", 2022L:2024L),
                        tribble(~Division, ~Season,
                                "South", 2021L,
                                "West", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Gazi-Stadion auf der Waldau (Waldau-Stadion)", "Stuttgart, DE", 1, 48.753944, 9.188417, 2021L:2023L,
                                "PreZero Arena (Rhein-Neckar-Arena)", "Sinsheim, DE", 1/6, 49.238056, 8.8875, 2024L,
                                "Stadion an der Kreuzeiche", "Reutlingen, DE", 2/6, 48.478611, 9.19, 2024L,
                                "Gazi-Stadion auf der Waldau (Waldau-Stadion)", "Stuttgart, DE", 3/6, 48.753944, 9.188417, 2024L,
                                "Gazi-Stadion auf der Waldau (Waldau-Stadion)", "Stuttgart, DE", 1, 48.753944, 9.188417, 2025L:present),
             "Thunder", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Berlin Thunder", "BT", "BTH", 2021L:present),
                        tribble(~Conference, ~Season,
                                "Northern", 2022L,
                                "Eastern", 2023L:2024L),
                        tribble(~Division, ~Season,
                                "North", c(2021L,2025L:present)),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Olympiapark-Amateurstadion (Stadion auf dem Wurfplatz)", "Berlin, DE", 2/5, 52.517191, 13.236694, 2021L,
                                "Friedrich-Ludwig-Jahn-Sportpark", "Berlin, DE", 3/5, 52.543056, 13.405278, 2021L,
                                "Friedrich-Ludwig-Jahn-Sportpark", "Berlin, DE", 1, 52.543056, 13.405278, 2022L:present),
  ### U V W X Y Z ----
             "Vikings", tribble(~Team, ~Abb2, ~Abb3, ~Season,
                                "Vienna Vikings", "VV", "VIK", 2022L:present),
                        tribble(~Conference, ~Season,
                                "Central", 2022L,
                                "Eastern", 2023L:2024L),
                        tribble(~Division, ~Season,
                                "East", 2025L:present),
                        tribble(~Stadium, ~Location, ~Gs, ~Lat, ~Long, ~Season,
                                "Generali Arena", "Vienna, AT", 1, 48.162345, 16.387156, 2022L,
                                "Generali Arena", "Vienna, AT", 1/6, 48.162345, 16.387156, 2023L,
                                "Naturarena Hohe Warte", "Vienna, AT", 4/6, 48.248898, 16.359694, 2023L,
                                "Footballzentrum Ravelinstraße", "Vienna, AT", 1/6, 48.172145848736214, 16.425254712887714, 2023L,
                                "Generali Arena", "Vienna, AT", 3/6, 48.162345, 16.387156, 2024L,
                                "Wiener Neustadt Arena", "Wr. Neustadt, AT", 3/6, 47.840926, 16.257464, 2024L,
                                "Naturarena Hohe Warte", "Vienna, AT", 2/6, 48.248898, 16.359694, 2025L,
                                "Generali Arena", "Vienna, AT", 2/6, 48.162345, 16.387156, 2025L,
                                "Wiener Neustadt Arena", "Wr. Neustadt, AT", 1/6, 47.840926, 16.257464, 2025L,
                                "Bundesstadion Südstadt", "Maria Enzersdorf, AT", 1/6, 48.097593, 16.310936, 2025L)
)

# TRANSFORM ----
## Teamdata ----
teamdata_elf <- teamdata_elf |>
  mutate(across(Team:HomeField, ~ modify(.x, ~ unnest_longer(., "Season")))) # expandiere Seasons in nested tibbles

## Team_info ----
teaminfo_elf <-
  select(teamdata_elf, Franchise, Team) |> unnest_longer(Team) |> unpack(Team) |>                   # extrahiere TEAM Info
  left_join(
    select(teamdata_elf, Franchise, Conference) |> unnest_longer(Conference) |> unpack(Conference), # extrahiere CONFERENCE Info
    by = c("Franchise", "Season")) |>
  left_join(
    select(teamdata_elf, Franchise, Division) |> unnest_longer(Division) |> unpack(Division),       # extrahiere DIVISION Info
    by = c("Franchise", "Season"))

## Team_location ----
teamloc_elf <- 
  select(teamdata_elf, Franchise, HomeField) |> unnest_longer(HomeField) |> unpack(HomeField) |> # extrahiere HOMEFIELD Info
  left_join(
    teaminfo_elf |> select(Season, Franchise, Conference, Division),
    by = c("Franchise", "Season"))

# DIVISION/CONFERENCE COLORS ----
## Colors ---- by elpedia.eu/ELF_Divisions
colors_elf <- list(
  Division = tribble(~Name, ~Color, ~Season,
                     "North", "#1f3f77", 2021L,
                     "South", "#cd2028", 2021L,
                     "East", "#dfdf39", 2025L:present,
                     "North", "#1f3f77", 2025L:present,
                     "South", "#ac162c", 2025L:present,
                     "West", "#005030", 2025L:present),
  Conference = tribble(~Name, ~Color, ~Season,
                       "Central", "#008000", 2022L:2024L,
                       "Northern", "#1f3f77", 2022L,
                       "Southern", "#cd2028", 2022L,
                       "Eastern", "#cd2028", 2023L:2024L,
                       "Western", "#1f3f77", 2023L:2024L)
)

## Expandiere ----  
colors_elf <- lapply(colors_elf, unnest_longer, "Season")

# RESPONSE ----
cat("..ELF > Team data imported ✔\n")

# CLEAN UP ----
rm(present, teamdata_elf)